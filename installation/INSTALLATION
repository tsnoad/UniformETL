UNIFORM ETL

Installation
------------

1. Get Files. Recommended installation path is /home/uetl/

2. Create folders
mkdir logs
mkdir extract/extract_processes

3. Create permanent link to config files
ln -s /home/uetl/ /etc/uniformetl

4. Create config files from templates
cp config.template.php config.php

5. Edit Config file
nano config.php

6. Set correct permissions
chown -R tsnoad:tsnoad /home/uetl/
chmod -R 744 /home/uetl/
chmod 755 /home/uetl/
chmod 755 /home/uetl/extract/
chmod -R 755 /home/uetl/extract/extract_processes/

6. create database and load schema
createdb hotel
psql hotel < create.sql

7. create ssh key for data source server.
ssh-keygen -t rsa -f ~/.ssh/id_rsa_something
cat ~/.ssh/id_rsa_something.pub | ssh remote.server.com "cat >> ~/.ssh/authorized_keys2"

8. Add Extract Daemon to root's crontab
#UETL Extract Daemon: waits for source data, starts extract, monitors progress.
* * * * * su - tsnoad -c '/home/uetl/extract/extract_daemon.php >> /home/uetl/logs/extractdaemonlog'

9. Add Transform Daemon to root's crontab
#UETL Transform Daemon: waits for extract to finish, starts transform, monitors progress.
* * * * * su - tsnoad -c '/home/uetl/transform/transform_daemon.php >> /home/uetl/logs/transformdaemonlog'

10. Add janitor script to root's crontab
#Janitor script: cleans up dump tables and extract folders for completed processes
0 * * * * su - tsnoad -c '/home/hotel/janitor/run_janitor.php >> /home/hotel/logs/janitorlog'

11. Add cleanup scripts to root's crontab
#Periodically run VACUUM and ANALYZE to keep the database uncluttered
0 6 * * * su - tsnoad -c 'pg_vacuum --dbname=hotel --analyze'

12. Wait for Daemon to find data and start extracting...


Configuring API
---------------

1. Make sure mod_rewrite is installed and enabled

2. Create the .htaccess file from template
cp /home/uetl/api/.htaccess.template /home/uetl/api/.htaccess

3. Edit .htaccess files
nano /home/uetl/api/.htaccess

4. Configure apache to make /home/uetl/api/ available

5. Configure apache to obey /home/uetl/api/.htaccess


